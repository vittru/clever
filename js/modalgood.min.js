
function modifyBasket(){var a=false;$(".quantity:visible").each(function(){if($(this).val()>0){a=true}});$(".aa-add-to-cart-btn").attr("disabled",!a);$(".aa-quick-order-btn").attr("disabled",!a)}$(".aa-add-to-cart-btn").click(function e(){$(this).text("Добавлено");yaCounter44412517.reachGoal("INCART");var a=$("#pId").text();var b=[];$(".quantity:visible").each(function(){if($(this).val()>0){var c={};c.goodId=a;c.sizeId=$(this).prop("id").substring(3);c.count=$(this).val();c.price=$(this).attr("data-price");c.sale=$(this).attr("data-sale");b.push(c)}});$.ajax({type:"POST",url:"/cart/add",data:{data:JSON.stringify(b)},success:function(){$("#cartbox").load(location.href+" #cartbox>*","")}})});$(".aa-quick-order-btn").click(function e(){$("#quickOrderOrder").show();$("#quickOrderComplete").hide();var b=$("#pId").text();var a=1;var c=0;$(".quantity:visible").each(function(){if($(this).val()>0){$("#quickOrderGoodId").val(b);$("#quickOrderSizeId"+a).val($(this).prop("id").substring(3));$("#quickOrderSizeSale"+a).val($(this).attr("data-sale"));$("#quickOrderSize"+a).html($(this).attr("data-size"));$("#quickOrderQuantity"+a).html($(this).val());$("#quickOrderQuantity"+a).parent().show();$("#quickOrderPrice"+a).html($(this).attr("data-price"));c=+c+ +$(this).attr("data-price")*+$(this).val();a++}});for(j=a;j<=3;j++){$("#quickOrderQuantity"+j).parent().hide()}$("#quickOrderTotalPrice").html(c)});$("#quickOrderSubmit").click(function e(){var a=[];var b={};b.goodId=$("#quickOrderGoodId").val();b.sizeId=$("#quickOrderSizeId1").val();b.count=$("#quickOrderQuantity1").html();b.price=$("#quickOrderPrice1").html();b.sale=$("#quickOrderSizeSale1").val();a.push(b);if($("#quickOrderSizeId2").val()){var b={};b.goodId=$("#quickOrderGoodId").val();b.sizeId=$("#quickOrderSizeId2").val();b.count=$("#quickOrderQuantity2").html();b.price=$("#quickOrderPrice2").html();b.sale=$("#quickOrderSizeSale2").val();a.push(b)}if($("#quickOrderSizeId3").val()){var b={};b.goodId=$("#quickOrderGoodId").val();b.sizeId=$("#quickOrderSizeId3").val();b.count=$("#quickOrderQuantity3").html();b.price=$("#quickOrderPrice3").html();b.sale=$("#quickOrderSizeSale3").val();a.push(b)}$.ajax({type:"POST",url:"/buy/quick",data:{data:JSON.stringify(a),email:$("#quickOrderEmail").val(),phone:$("#quickOrderPhone").val()},success:function(c){if(!isNaN(c)){$("#quickOrderId").html(c);$("#quickOrderOrder").hide();$("#quickOrderComplete").show()}else{$("#quickOrderError").show();$("#quickOrderError").html(c)}}})});$(document).on("mouseleave",".aa-add-to-cart-btn",function(){$(this).parent().find(".aa-add-to-cart-btn").html('<span class="fa fa-shopping-cart"></span>В корзину')});$('a[data-toggle="tab"]').on("shown.bs.tab",function(b){var a=$(b.target).attr("href");modifyBasket();if(a==="#bb"){$(".aa-add-to-cart-btn").show();$(".aa-quick-order-btn").show();$("#emailMeBtn").hide()}else{if(!$(".quantity:visible").length){$(".aa-add-to-cart-btn").hide();$(".aa-quick-order-btn").hide();$("#emailMeBtn").show()}}});