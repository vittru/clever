
/*!
 * jquery.sumoselect - v3.0.2
 * http://hemantnegi.github.io/jquery.sumoselect
 * 2014-04-08
 *
 * Copyright 2015 Hemant Negi
 * Email : hemant.frnz@gmail.com
 * Compressor http://refresh-sf.com/
 */
(function(a){a.fn.SumoSelect=function(c){var d=a.extend({placeholder:"Select Here",csvDispCount:3,captionFormat:"{0} Selected",captionFormatAllSelected:"{0} all selected!",floatWidth:400,forceCustomRendering:false,nativeOnDevice:["Android","BlackBerry","iPhone","iPad","iPod","Opera Mini","IEMobile","Silk"],outputAsCSV:false,csvSepChar:",",okCancelInMulti:false,triggerChangeCombined:true,selectAll:false,search:false,searchText:"Search...",noMatch:'No matches for "{0}"',prefix:"",locale:["OK","Cancel","Select All"],up:false},c);var b=this.each(function(){var e=this;if(this.sumo||!a(this).is("select")){return}this.sumo={E:a(e),is_multi:a(e).attr("multiple"),select:"",caption:"",placeholder:"",optDiv:"",CaptionCont:"",ul:"",is_floating:false,is_opened:false,mob:false,Pstate:[],createElems:function(){var f=this;f.E.wrap('<div class="SumoSelect" tabindex="0">');f.select=f.E.parent();f.caption=a("<span>");f.CaptionCont=a('<p class="CaptionCont"><label><i></i></label></p>').addClass("SelectBox").attr("style",f.E.attr("style")).prepend(f.caption);f.select.append(f.CaptionCont);if(!f.is_multi){d.okCancelInMulti=false}if(f.E.attr("disabled")){f.select.addClass("disabled").removeAttr("tabindex")}if(d.outputAsCSV&&f.is_multi&&f.E.attr("name")){f.select.append(a('<input class="HEMANT123" type="hidden" />').attr("name",f.E.attr("name")).val(f.getSelStr()));f.E.removeAttr("name")}if(f.isMobile()&&!d.forceCustomRendering){f.setNativeMobile();return}if(f.E.attr("name")){f.select.addClass("sumo_"+f.E.attr("name"))}f.E.addClass("SumoUnder").attr("tabindex","-1");f.optDiv=a('<div class="optWrapper '+(d.up?"up":"")+'">');f.floatingList();f.ul=a('<ul class="options">');f.optDiv.append(f.ul);if(d.selectAll){f.SelAll()}if(d.search){f.Search()}f.ul.append(f.prepItems(f.E.children()));if(f.is_multi){f.multiSelelect()}f.select.append(f.optDiv);f.basicEvents();f.selAllState()},prepItems:function(g,j){var f=[],h=this;a(g).each(function(l,k){k=a(k);f.push(k.is("optgroup")?a('<li class="group '+(k[0].disabled?"disabled":"")+'"><label>'+k.attr("label")+"</label><ul></ul><li>").find("ul").append(h.prepItems(k.children(),k[0].disabled)).end():h.createLi(k,j))});return f},createLi:function(f,h){var g=this;if(!f.attr("value")){f.attr("value",f.val())}li=a('<li class="opt"><label>'+f.text()+"</label></li>");li.data("opt",f);f.data("li",li);if(g.is_multi){li.prepend("<span><i></i></span>")}if(f[0].disabled||h){li=li.addClass("disabled")}g.onOptClick(li);if(f[0].selected){li.addClass("selected")}if(f.attr("class")){li.addClass(f.attr("class"))}return li},getSelStr:function(){sopt=[];this.E.find("option:selected").each(function(){sopt.push(a(this).val())});return sopt.join(d.csvSepChar)},multiSelelect:function(){var f=this;f.optDiv.addClass("multiple");f.okbtn=a('<p class="btnOk">'+d.locale[0]+"</p>").click(function(){if(d.triggerChangeCombined){changed=false;if(f.E.find("option:selected").length!=f.Pstate.length){changed=true}else{f.E.find("option").each(function(g,h){if(h.selected&&f.Pstate.indexOf(g)<0){changed=true}})}if(changed){f.callChange();f.setText()}}f.hideOpts()});f.cancelBtn=a('<p class="btnCancel">'+d.locale[1]+"</p>").click(function(){f._cnbtn();f.hideOpts()});f.optDiv.append(a('<div class="MultiControls">').append(f.okbtn).append(f.cancelBtn))},_cnbtn:function(){var g=this;g.E.find("option:selected").each(function(){this.selected=false});g.optDiv.find("li.selected").removeClass("selected");for(var f=0;f<g.Pstate.length;f++){g.E.find("option")[g.Pstate[f]].selected=true;g.ul.find("li.opt").eq(g.Pstate[f]).addClass("selected")}g.selAllState()},SelAll:function(){var f=this;if(!f.is_multi){return}f.selAll=a('<p class="select-all"><span><i></i></span><label>'+d.locale[2]+"</label></p>");f.selAll.on("click",function(){f.selAll.toggleClass("selected");f.optDiv.find("li.opt").not(".hidden").each(function(g,h){h=a(h);if(f.selAll.hasClass("selected")){if(!h.hasClass("selected")){h.trigger("click")}}else{if(h.hasClass("selected")){h.trigger("click")}}})});f.optDiv.prepend(f.selAll)},Search:function(){var g=this,h=g.CaptionCont.addClass("search"),f=a('<p class="no-match">');g.ftxt=a('<input type="text" class="search-txt" value="" placeholder="'+d.searchText+'">').on("click",function(j){j.stopPropagation()});h.append(g.ftxt);g.optDiv.children("ul").after(f);g.ftxt.on("keyup.sumo",function(){var j=g.optDiv.find("ul.options li.opt").each(function(k,l){l=a(l);if(l.text().toLowerCase().indexOf(g.ftxt.val().toLowerCase())>-1){l.removeClass("hidden")}else{l.addClass("hidden")}}).not(".hidden");f.html(d.noMatch.replace(/\{0\}/g,g.ftxt.val())).toggle(!j.length);g.selAllState()})},selAllState:function(){var g=this;if(d.selectAll){var h=0,f=0;g.optDiv.find("li.opt").not(".hidden").each(function(j,k){if(a(k).hasClass("selected")){h++}if(!a(k).hasClass("disabled")){f++}});if(h==f){g.selAll.removeClass("partial").addClass("selected")}else{if(h==0){g.selAll.removeClass("selected partial")}else{g.selAll.addClass("partial")}}}},showOpts:function(){var f=this;if(f.E.attr("disabled")){return}f.is_opened=true;f.select.addClass("open");if(f.ftxt){f.ftxt.focus()}else{f.select.focus()}a(document).on("click.sumo",function(g){if(!f.select.is(g.target)&&f.select.has(g.target).length===0){if(!f.is_opened){return}f.hideOpts();if(d.okCancelInMulti){f._cnbtn()}}});if(f.is_floating){H=f.optDiv.children("ul").outerHeight()+2;if(f.is_multi){H=H+parseInt(f.optDiv.css("padding-bottom"))}f.optDiv.css("height",H);a("body").addClass("sumoStopScroll")}f.setPstate()},setPstate:function(){var f=this;if(f.is_multi&&(f.is_floating||d.okCancelInMulti)){f.Pstate=[];f.E.find("option").each(function(g,h){if(h.selected){f.Pstate.push(g)}})}},callChange:function(){this.E.trigger("change").trigger("click")},hideOpts:function(){var f=this;if(f.is_opened){f.is_opened=false;f.select.removeClass("open").find("ul li.sel").removeClass("sel");a(document).off("click.sumo");f.select.focus();a("body").removeClass("sumoStopScroll");if(d.search){f.ftxt.val("");f.optDiv.find("ul.options li").removeClass("hidden");f.optDiv.find(".no-match").toggle(false)}}},setOnOpen:function(){var g=this,f=g.optDiv.find("li.opt:not(.hidden)").eq(d.search?0:g.E[0].selectedIndex);g.optDiv.find("li.sel").removeClass("sel");f.addClass("sel");g.showOpts()},nav:function(g){var h=this,k,o=h.ul.find("li.opt:not(.disabled, .hidden)"),f=h.ul.find("li.opt.sel:not(.hidden)"),l=o.index(f);if(h.is_opened&&f.length){if(g&&l>0){k=o.eq(l-1)}else{if(!g&&l<o.length-1&&l>-1){k=o.eq(l+1)}else{return}}f.removeClass("sel");f=k.addClass("sel");var j=h.ul,n=j.scrollTop(),m=f.position().top+n;if(m>=n+j.height()-f.outerHeight()){j.scrollTop(m-j.height()+f.outerHeight())}if(m<n){j.scrollTop(m)}}else{h.setOnOpen()}},basicEvents:function(){var f=this;f.CaptionCont.click(function(g){f.E.trigger("click");if(f.is_opened){f.hideOpts()}else{f.showOpts()}g.stopPropagation()});f.select.on("keydown.sumo",function(g){switch(g.which){case 38:f.nav(true);break;case 40:f.nav(false);break;case 32:if(d.search&&f.ftxt.is(g.target)){return}case 13:if(f.is_opened){f.optDiv.find("ul li.sel").trigger("click")}else{f.setOnOpen()}break;case 9:case 27:if(d.okCancelInMulti){f._cnbtn()}f.hideOpts();return;default:return}g.preventDefault()});a(window).on("resize.sumo",function(){f.floatingList()})},onOptClick:function(f){var g=this;f.click(function(){var h=a(this);if(h.hasClass("disabled")){return}txt="";if(g.is_multi){h.toggleClass("selected");h.data("opt")[0].selected=h.hasClass("selected");g.selAllState()}else{h.parent().find("li.selected").removeClass("selected");h.toggleClass("selected");h.data("opt")[0].selected=true}if(!(g.is_multi&&d.triggerChangeCombined&&(g.is_floating||d.okCancelInMulti))){g.setText();g.callChange()}if(!g.is_multi){g.hideOpts()}})},setText:function(){var f=this;f.placeholder="";if(f.is_multi){sels=f.E.find(":selected").not(":disabled");for(i=0;i<sels.length;i++){if(i+1>=d.csvDispCount&&d.csvDispCount){if(sels.length==f.E.find("option").length&&d.captionFormatAllSelected){f.placeholder=d.captionFormatAllSelected.replace(/\{0\}/g,sels.length)+","}else{f.placeholder=d.captionFormat.replace(/\{0\}/g,sels.length)+","}break}else{f.placeholder+=a(sels[i]).text()+", "}}f.placeholder=f.placeholder.replace(/,([^,]*)$/,"$1")}else{f.placeholder=f.E.find(":selected").not(":disabled").text()}is_placeholder=false;if(!f.placeholder){is_placeholder=true;f.placeholder=f.E.attr("placeholder");if(!f.placeholder){f.placeholder=f.E.find("option:disabled:selected").text()}}f.placeholder=f.placeholder?(d.prefix+" "+f.placeholder):d.placeholder;f.caption.html(f.placeholder);f.CaptionCont.attr("title",f.placeholder);csvField=f.select.find("input.HEMANT123");if(csvField.length){csvField.val(f.getSelStr())}if(is_placeholder){f.caption.addClass("placeholder")}else{f.caption.removeClass("placeholder")}return f.placeholder},isMobile:function(){var g=navigator.userAgent||navigator.vendor||window.opera;for(var f=0;f<d.nativeOnDevice.length;f++){if(g.toString().toLowerCase().indexOf(d.nativeOnDevice[f].toLowerCase())>0){return d.nativeOnDevice[f]}}return false},setNativeMobile:function(){var f=this;f.E.addClass("SelectClass");f.mob=true;f.E.change(function(){f.setText()})},floatingList:function(){var f=this;f.is_floating=a(window).width()<=d.floatWidth;f.optDiv.toggleClass("isFloating",f.is_floating);if(!f.is_floating){f.optDiv.css("height","")}f.optDiv.toggleClass("okCancelInMulti",d.okCancelInMulti&&!f.is_floating)},vRange:function(f){var g=this;opts=g.E.find("option");if(opts.length<=f||f<0){throw"index out of bounds"}return g},toggSel:function(h,f){var g=this;if(typeof(f)==="number"){g.vRange(f);opt=g.E.find("option")[f]}else{opt=g.E.find('option[value="'+f+'"]')[0]||0}if(!opt||opt.disabled){return}if(opt.selected!=h){opt.selected=h;if(!g.mob){a(opt).data("li").toggleClass("selected",h)}g.callChange();g.setPstate();g.setText();g.selAllState()}},toggDis:function(h,f){var g=this.vRange(f);g.E.find("option")[f].disabled=h;if(h){g.E.find("option")[f].selected=false}if(!g.mob){g.optDiv.find("ul.options li").eq(f).toggleClass("disabled",h).removeClass("selected")}g.setText()},toggSumo:function(g){var f=this;f.enabled=g;f.select.toggleClass("disabled",g);if(g){f.E.attr("disabled","disabled");f.select.removeAttr("tabindex")}else{f.E.removeAttr("disabled");f.select.attr("tabindex","0")}return f},toggSelAll:function(g){var f=this;f.E.find("option").each(function(h,j){if(f.E.find("option")[a(this).index()].disabled){return}f.E.find("option")[a(this).index()].selected=g;if(!f.mob){f.optDiv.find("ul.options li").eq(a(this).index()).toggleClass("selected",g)}f.setText()});if(!f.mob&&f.selAll){f.selAll.removeClass("partial").toggleClass("selected",g)}f.callChange();f.setPstate()},reload:function(){var f=this.unload();return a(f).SumoSelect(d)},unload:function(){var f=this;f.select.before(f.E);f.E.show();if(d.outputAsCSV&&f.is_multi&&f.select.find("input.HEMANT123").length){f.E.attr("name",f.select.find("input.HEMANT123").attr("name"))}f.select.remove();delete e.sumo;return e},add:function(j,f,g){if(typeof j=="undefined"){throw"No value to add"}var h=this;opts=h.E.find("option");if(typeof f=="number"){g=f;f=j}if(typeof f=="undefined"){f=j}opt=a("<option></option>").val(j).html(f);if(opts.length<g){throw"index out of bounds"}if(typeof g=="undefined"||opts.length==g){h.E.append(opt);if(!h.mob){h.ul.append(h.createLi(opt))}}else{opts.eq(g).before(opt);if(!h.mob){h.ul.find("li.opt").eq(g).before(h.createLi(opt))}}return e},remove:function(f){var g=this.vRange(f);g.E.find("option").eq(f).remove();if(!g.mob){g.optDiv.find("ul.options li").eq(f).remove()}g.setText()},selectItem:function(f){this.toggSel(true,f)},unSelectItem:function(f){this.toggSel(false,f)},selectAll:function(){this.toggSelAll(true)},unSelectAll:function(){this.toggSelAll(false)},disableItem:function(f){this.toggDis(true,f)},enableItem:function(f){this.toggDis(false,f)},enabled:true,enable:function(){return this.toggSumo(false)},disable:function(){return this.toggSumo(true)},init:function(){var f=this;f.createElems();f.setText();return f}};e.sumo.init()});return b.length==1?b[0]:b}}(jQuery));